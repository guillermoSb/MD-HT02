---
title: "Hoja de Trabajo 02"
output: html_notebook
---

# Hoja de Trabajo 02

Librerías
```{r}
library(hopkins)
library(cluster) #Para calcular la silueta
library(e1071)#para cmeans
library(mclust) #mixtures of gaussians
library(fpc) #para hacer el plotcluster
library(NbClust) #Para determinar el número de clusters óptimo
library(factoextra) #Para hacer gráficos bonitos de clustering
library(hopkins) #Para revisar si vale la pena hacer agrupamiento
library(GGally) #Para hacer el conjunto de graficos
library(FeatureImpCluster) #Para revisar la importancia de las variables en los grupos.
library(pheatmap) #Para hacer mapa de calor

```

## 1 Prepocesamiento
```{r,warning=FALSE}
movies <- read.csv("movies.csv")

# Add release_year and release_month
years <- c(as.POSIXlt(movies$releaseDate)$year + 1900)
months <- c(as.POSIXlt(movies$releaseDate)$mon + 1)
movies$releaseYear = years
movies$releaseMonth = months

# Add average actor popularity
splittedPopularities <- strsplit(movies$actorsPopularity, "\\|")
averagePopularities <- unlist(lapply(lapply(splittedPopularities, as.numeric), mean))
movies$averageActorPopularities <- averagePopularities
```
Resumen de columnas a utilizar para Clustering:

```{r}
print(summary(movies[,importantCols]))
```




## 2 Tendencia de Agrupamiento

``` {r}
# Define important columns for Hopkins and VAT
importantCols <- c("budget", "revenue", "popularity", "voteAvg", "genresAmount","releaseYear", "releaseMonth", "averageActorPopularities")

```

### Hopkins
```{r}
seed <- 1407
set.seed(seed)
hopkins_statistic <- hopkins(movies[, importantCols], m=1000)
```
El resultado del test de Hopkins es `r hopkins_statistic`, el valor es cercano a 1, según la librería que se está utilizando esto indica una tendencia a clustering alta.

### VAT

```{r}
#Matriz de distancia
datos_dist<- dist(movies[1:1000, importantCols[1:3]])
fviz_dist(datos_dist, show_labels = F, gradient = list(low = "#000000", mid = "white", high = "#FC4E3F"))
```
El VAT si demuestra patrones de agrupamiento, por lo que podemos confiar en el resultado del test de Hopkins.



